require('shelljs/global');
var fs = require('fs');
var GIT_REPO_PATH = 'http://git.jdb-dev.com/uranus/core.git';

function cloneOrPull() {
    try {
        fs.accessSync('./core-publisher');
        cd('core-publisher');
        exec('git pull');
        exec('npm install');
    } catch (err) {
        exec('git clone ' + GIT_REPO_PATH + ' core-publisher');
        cd('core-publisher');
        exec('npm install');
    }
}

function publishAndCopyCore() {
    // cd('cd core-publisher');
    exec('gulp local');
    cp('-rf', './dist/*', '../temp-core');
}

cloneOrPull();
publishAndCopyCore();
