var gulp = require('gulp');
var del = require('del');
var config = require('../config');
// var shell = require('shelljs/global');
var browserSync = require('browser-sync');
var fs = require('fs');

gulp.task('prepare', ['make-pre-commit'], function () {
    return del([
        config.destBase
    ], {
        dot: true
    });
});

gulp.task('make-pre-commit', function () {
    if (!fs.existsSync('./.git/hooks/pre-commit')) {
        gulp.src(__dirname + '/../pre-commit')
            .pipe(gulp.dest('./.git/hooks/'))
            .on('end', function () {
                fs.chmodSync('./.git/hooks/pre-commit', '755');
            });
    }
});

// gulp.task('update', function () {
//     var result = exec('npm update shelljs');
//     console.log(result.stdout);
//     if (result.code != 0) {
//         console.log(result.stderr);
//     }
//     if (result.stdout) {
//         console.log('更新成功，请重新执行脚本');
//     }
//     return;
// });
